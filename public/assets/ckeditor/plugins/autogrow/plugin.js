/*
 Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.html or http://ckeditor.com/license
*/
(function(){var e=function(e){if(e.window){var t=e.document;new CKEDITOR.dom.element(t.getWindow().$.frameElement);var n=t.getBody(),r=t.getDocumentElement(),i=e.window.getViewPaneSize().height,t="BackCompat"==t.$.compatMode?n:r,n=t.getStyle("overflow-y"),s=t.getDocument(),r=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"</span>",s);s[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(r),s=r.getDocumentPosition(s).y+r.$.offsetHeight,r.remove(),t.setStyle("overflow-y",n),n=s+(e.config.autoGrow_bottomSpace||0),r=e.config.autoGrow_maxHeight||Infinity,n=Math.max(n,void 0!=e.config.autoGrow_minHeight?e.config.autoGrow_minHeight:200),n=Math.min(n,r),n!=i&&(n=e.fire("autoGrow",{currentHeight:i,newHeight:n}).newHeight,e.resize(e.container.getStyle("width"),n,!0)),t.$.scrollHeight>t.$.clientHeight&&n<r?t.setStyle("overflow-y","hidden"):t.removeStyle("overflow-y")}};CKEDITOR.plugins.add("autogrow",{init:function(t){t.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE&&t.on("instanceReady",function(){if(t.editable().isInline())t.ui.space("contents").setStyle("height","auto");else{t.addCommand("autogrow",{exec:e,modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var n={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1},r;for(r in n)t.on(r,function(n){var r=t.getCommand("maximize");"wysiwyg"==n.editor.mode&&(!r||r.state!=CKEDITOR.TRISTATE_ON)&&setTimeout(function(){e(n.editor),e(n.editor)},100)});t.config.autoGrow_onStartup&&t.execCommand("autogrow")}})}})})();